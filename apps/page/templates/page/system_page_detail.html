{% extends 'core/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{{ page.name }} - KinoCMS{% endblock %}


{% block extra_css %}
{% endblock %}

{% block content %}
<div class="container">
    <!-- Page Banner -->
    <div class="page-banner {% if not page.logo %}no-image{% endif %}">
        {% if page.logo %}
            <img src="{{ page.logo.url }}" alt="{{ page.name }}">
        {% else %}
            <div>
                <i class="fas fa-image"></i>
                <p class="mb-0">{% trans "Изображение недоступно" %}</p>
            </div>
        {% endif %}
    </div>
    
    <!-- Page Title -->
    <h1 class="page-title">
        {% get_current_language as LANGUAGE_CODE %}
        {% if LANGUAGE_CODE == 'uk' and page.name_uk %}
            {{ page.name_uk }}
        {% else %}
            {{ page.name }}
        {% endif %}
    </h1>
    
    <!-- Page Description -->
    {% if page.description %}
        <div class="page-description">
            {% get_current_language as LANGUAGE_CODE %}
            {% if LANGUAGE_CODE == 'uk' and page.description_uk %}
                {{ page.description_uk|linebreaks }}
            {% else %}
                {{ page.description|linebreaks }}
            {% endif %}
        </div>
    {% else %}
        <div class="no-description">
            <i class="fas fa-info-circle me-2"></i>
            {% trans "Описание для данной страницы пока не добавлено." %}
        </div>
    {% endif %}
    
    <!-- Photo Gallery -->
    {% if page.gallery and page.gallery.images.exists %}
        <div class="page-gallery">
            <h2 class="gallery-title">
                <i class="fas fa-images me-2"></i>
                {% trans "Фотогалерея" %}
            </h2>
            
            <div class="gallery-grid">
                {% for image in page.gallery.images.all %}
                    <div class="gallery-item" onclick="openGalleryModal('{{ image.image.url }}')">
                        <img src="{{ image.image.url }}" alt="{% trans 'Изображение галереи' %} {{ forloop.counter }}">
                    </div>
                {% endfor %}
            </div>
        </div>
    {% else %}
        <div class="no-gallery">
            <i class="fas fa-images me-2"></i>
            {% trans "Фотогалерея для данной страницы пока не добавлена." %}
        </div>
    {% endif %}
</div>

<!-- Gallery Modal -->
<div class="gallery-modal" id="galleryModal" onclick="closeGalleryModal()">
    <div class="gallery-modal-content">
        <span class="gallery-modal-close" onclick="closeGalleryModal()">&times;</span>
        <img id="galleryModalImage" src="" alt="{% trans 'Полное изображение' %}">
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Gallery modal functionality
    function openGalleryModal(imageSrc) {
        const modal = document.getElementById('galleryModal');
        const modalImage = document.getElementById('galleryModalImage');
        
        modalImage.src = imageSrc;
        modal.classList.add('active');
        
        // Prevent body scrolling
        document.body.style.overflow = 'hidden';
    }
    
    function closeGalleryModal() {
        const modal = document.getElementById('galleryModal');
        modal.classList.remove('active');
        
        // Restore body scrolling
        document.body.style.overflow = 'auto';
    }
    
    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeGalleryModal();
        }
    });
    
    // Prevent modal content click from closing modal
    document.querySelector('.gallery-modal-content').addEventListener('click', function(e) {
        e.stopPropagation();
    });
</script>
{% endblock %}